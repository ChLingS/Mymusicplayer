import{_ as T,r as _,w as P,o as V,Q as z,G as h,H as m,L as p,h as S,R as O,S as y,U as B,F as k,O as x,c as F,M as C,V as J,W,P as G}from"./_plugin-vue_export-helper-e232eb61.js";var H=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var D={exports:{}};(function(f,c){(function(A,g){f.exports=g()})(H,function(){function A(e){var d=[];return e.AMapUI&&d.push(g(e.AMapUI)),e.Loca&&d.push(b(e.Loca)),Promise.all(d)}function g(e){return new Promise(function(d,o){var n=[];if(e.plugins)for(var a=0;a<e.plugins.length;a+=1)t.AMapUI.plugins.indexOf(e.plugins[a])==-1&&n.push(e.plugins[a]);if(s.AMapUI===i.failed)o("前次请求 AMapUI 失败");else if(s.AMapUI===i.notload){s.AMapUI=i.loading,t.AMapUI.version=e.version||t.AMapUI.version,a=t.AMapUI.version;var u=document.body||document.head,r=document.createElement("script");r.type="text/javascript",r.src="https://webapi.amap.com/ui/"+a+"/main.js",r.onerror=function(l){s.AMapUI=i.failed,o("请求 AMapUI 失败")},r.onload=function(){if(s.AMapUI=i.loaded,n.length)window.AMapUI.loadUI(n,function(){for(var l=0,w=n.length;l<w;l++){var M=n[l].split("/").slice(-1)[0];window.AMapUI[M]=arguments[l]}for(d();v.AMapUI.length;)v.AMapUI.splice(0,1)[0]()});else for(d();v.AMapUI.length;)v.AMapUI.splice(0,1)[0]()},u.appendChild(r)}else s.AMapUI===i.loaded?e.version&&e.version!==t.AMapUI.version?o("不允许多个版本 AMapUI 混用"):n.length?window.AMapUI.loadUI(n,function(){for(var l=0,w=n.length;l<w;l++){var M=n[l].split("/").slice(-1)[0];window.AMapUI[M]=arguments[l]}d()}):d():e.version&&e.version!==t.AMapUI.version?o("不允许多个版本 AMapUI 混用"):v.AMapUI.push(function(l){l?o(l):n.length?window.AMapUI.loadUI(n,function(){for(var w=0,M=n.length;w<M;w++){var L=n[w].split("/").slice(-1)[0];window.AMapUI[L]=arguments[w]}d()}):d()})})}function b(e){return new Promise(function(d,o){if(s.Loca===i.failed)o("前次请求 Loca 失败");else if(s.Loca===i.notload){s.Loca=i.loading,t.Loca.version=e.version||t.Loca.version;var n=t.Loca.version,a=t.AMap.version.startsWith("2"),u=n.startsWith("2");if(a&&!u||!a&&u)o("JSAPI 与 Loca 版本不对应！！");else{a=t.key,u=document.body||document.head;var r=document.createElement("script");r.type="text/javascript",r.src="https://webapi.amap.com/loca?v="+n+"&key="+a,r.onerror=function(l){s.Loca=i.failed,o("请求 AMapUI 失败")},r.onload=function(){for(s.Loca=i.loaded,d();v.Loca.length;)v.Loca.splice(0,1)[0]()},u.appendChild(r)}}else s.Loca===i.loaded?e.version&&e.version!==t.Loca.version?o("不允许多个版本 Loca 混用"):d():e.version&&e.version!==t.Loca.version?o("不允许多个版本 Loca 混用"):v.Loca.push(function(l){l?o(l):o()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var i;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(i||(i={}));var t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:i.notload,AMapUI:i.notload,Loca:i.notload},v={AMap:[],AMapUI:[],Loca:[]},I=[],j=function(e){typeof e=="function"&&(s.AMap===i.loaded?e(window.AMap):I.push(e))};return{load:function(e){return new Promise(function(d,o){if(s.AMap==i.failed)o("");else if(s.AMap==i.notload){var n=e.key,a=e.version,u=e.plugins;n?(window.AMap&&location.host!=="lbs.amap.com"&&o("禁止多种API加载方式混用"),t.key=n,t.AMap.version=a||t.AMap.version,t.AMap.plugins=u||t.AMap.plugins,s.AMap=i.loading,a=document.body||document.head,window.___onAPILoaded=function(l){if(delete window.___onAPILoaded,l)s.AMap=i.failed,o(l);else for(s.AMap=i.loaded,A(e).then(function(){d(window.AMap)}).catch(o);I.length;)I.splice(0,1)[0]()},u=document.createElement("script"),u.type="text/javascript",u.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+t.AMap.version+"&key="+n+"&plugin="+t.AMap.plugins.join(","),u.onerror=function(l){s.AMap=i.failed,o(l)},a.appendChild(u)):o("请填写key")}else if(s.AMap==i.loaded)if(e.key&&e.key!==t.key)o("多个不一致的 key");else if(e.version&&e.version!==t.AMap.version)o("不允许多个版本 JSAPI 混用");else{if(n=[],e.plugins)for(a=0;a<e.plugins.length;a+=1)t.AMap.plugins.indexOf(e.plugins[a])==-1&&n.push(e.plugins[a]);n.length?window.AMap.plugin(n,function(){A(e).then(function(){d(window.AMap)}).catch(o)}):A(e).then(function(){d(window.AMap)}).catch(o)}else if(e.key&&e.key!==t.key)o("多个不一致的 key");else if(e.version&&e.version!==t.AMap.version)o("不允许多个版本 JSAPI 混用");else{var r=[];if(e.plugins)for(a=0;a<e.plugins.length;a+=1)t.AMap.plugins.indexOf(e.plugins[a])==-1&&r.push(e.plugins[a]);j(function(){r.length?window.AMap.plugin(r,function(){A(e).then(function(){d(window.AMap)}).catch(o)}):A(e).then(function(){d(window.AMap)}).catch(o)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:i.notload,AMapUI:i.notload,Loca:i.notload},v={AMap:[],AMapUI:[],Loca:[]}}}})})(D);var R=D.exports;const Z=N(R);const U=f=>(J("data-v-a1b2b8a6"),f=f(),W(),f),q={class:"box"},Q=U(()=>p("h3",null,"Hello!",-1)),X=U(()=>p("span",null,"city:",-1)),K=U(()=>p("option",{value:"0"},"selet city",-1)),Y=["value"],$=U(()=>p("option",{value:"0"},"selet",-1)),ee=["value"],oe=["value"],ae=U(()=>p("div",{id:"container"},null,-1)),ne={__name:"APP",setup(f){let c=null,A=_([]),g=_([]),b=_([]),i=_(""),t=_("0"),s=_("0");const v=async()=>{const n=await(await fetch("/abc/aj/getcitycode")).json();A.value=n.result.hotcity},I=async o=>{let n=await fetch("/abc/aj/get_area/?citycode="+o);const{result:a}=await n.json();let u=Object.keys(a).map(r=>({area_id:r,area_name:a[r]}));g.value=u},j=async()=>{let o=A.value.find(l=>l.code==t.value).name+g.value.find(l=>l.area_id==s.value).area_name,r=(await(await fetch("https://restapi.amap.com/v3/geocode/geo?address="+String(o)+"&key=b5d17e738aa7c010bce787c441dd67c4")).json()).geocodes[0].location.split(",");console.log(r),c.setZoomAndCenter(12,r)},e=async()=>{let o=await fetch("/abc/at/shop?city_id="+t.value+"&area_id="+s.value);console.log(o);const n=await o.json();console.log(n),b=n.shop_data,console.log(b);var a='<div class="custom-content-marker">   <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path opacity=".3" d="M12 4C9.24 4 7 6.24 7 9c0 2.85 2.92 7.21 5 9.88c2.11-2.69 5-7 5-9.88c0-2.76-2.24-5-5-5zm0 7.5a2.5 2.5 0 0 1 0-5a2.5 2.5 0 0 1 0 5z" fill="currentColor"></path><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zM7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9z" fill="currentColor"></path><circle cx="12" cy="9" r="2.5" fill="currentColor"></circle></svg>   <div class="close-btn" onclick="clearMarker()">X</div></div>';n.shop_data.forEach(u=>{console.log(u.map_longitude);const r=new AMap.Marker({position:[u.map_longitude,u.map_latitude],content:a,title:u.shop_name});c.add(r)})},d=async()=>{const a=(await(await fetch("https://api.ipify.org?format=json")).json()).ip;console.log(a);let r=await(await fetch("https://restapi.amap.com/v3/ip?ip="+a+"&key=b5d17e738aa7c010bce787c441dd67c4")).json();console.log(r);let l=r.rectangle.split(";");console.log(l);let w=l[0].split(",").map(parseFloat),M=l[1].split(",").map(parseFloat),L=[(w[0]+M[0])/2,(w[1]+M[1])/2].map(String);console.log(L),c.setZoomAndCenter(12,L);let E=await(await fetch("https://restapi.amap.com/v3/weather/weatherInfo?city="+r.adcode+"&key=b5d17e738aa7c010bce787c441dd67c4")).json();i.value=E.lives[0].weather,console.log(i)};return P(t,o=>{I(o),s.value="0"}),P(s,o=>{o!=="0"&&(j(),e())}),V(()=>{v(),window._AMapSecurityConfig={securityJsCode:"	157eebb177a6db44bff167ca0ccc6482"},Z.load({key:"4d96c8606504fe02df00df71523b9e90",version:"2.0",plugins:["AMap.Scale","AMap.ToolBar","AMap.MapType","AMap.OverView","AMap.controlBar"]}).then(o=>{c=new o.Map("container",{viewMode:"3D",zoom:11,center:[116.397428,39.90923]}),c.addControl(new o.Scale({isOpen:!0})),c.addControl(new o.ToolBar),c.addControl(new o.MapType),c.addControl(new o.OverView),c.addControl(new o.controlBar)}).catch(o=>{})}),z(()=>{c==null||c.destroy()}),(o,n)=>(h(),m(k,null,[p("div",q,[Q,p("div",null,[X,S(p("select",{"onUpdate:modelValue":n[0]||(n[0]=a=>B(t)?t.value=a:t=a)},[K,(h(!0),m(k,null,x(y(A),(a,u)=>(h(),m("option",{key:u,value:a.code},C(a.name),9,Y))),128))],512),[[O,y(t)]]),F("   "),S(p("select",{"onUpdate:modelValue":n[1]||(n[1]=a=>B(s)?s.value=a:s=a)},[$,(h(!0),m(k,null,x(y(g),(a,u)=>(h(),m("option",{key:u,value:a.area_id},C(a.area_name),9,ee))),128))],512),[[O,y(s)]])]),p("div",null,[p("ul",null,[(h(!0),m(k,null,x(y(b),(a,u)=>(h(),m("li",{key:u,value:a.code},C(o.itme.shop_name),9,oe))),128))])])]),p("div",null,[p("button",{onClick:d},"回家"),p("p",null,"今天天气是："+C(y(i)),1)]),ae],64))}},te=T(ne,[["__scopeId","data-v-a1b2b8a6"]]);G(te).mount("#app");
